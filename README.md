# FF14WIKI NPC发言整合化项目 - NODE部分
2025年1月19日

## 此前版本的问题
* `{{ballonAsk}}`一次可以查一个发言ID的多个语言数据，但是通常页面上需要查询多个数据。因此需要考虑在调用模板时输入多个发言ID，并仅进行一次查询来获取多条、多个语言的数据。
* NPC发言数据目前分为Ballon、InstanceContentTextData、NpcYell三种。如果希望WIKI侧使用统一的方法查询，则数据格式也应当保持一致。
* WIKI上的语言选择控件需要改进。计划改成控件能控制页面上所有的Ballon，多个控件之间相互联动。该功能不在NODE部分考虑范围之内。

## 目前已有的资料
Celes提供了CHS、KO、DE、EN、FR、JA六种语言的，上述三种发言类型的数据，CSV格式。

目前CSV的格式大致如下：

| key   | 0        | 1        | ... |
| ----- | -------- | -------- | --- |
| #     | col1     | col2     | ... |
| int32 | bit&01   | str      | ... |
| id    | 具体数据 | 具体数据 | ... |
| ...   | ...      | ...      | ... |

## 计划

1. 编写针对这种格式CSV的parser，先将三类数据的CSV数据整理为`Record<string,any>[]`。
2. 根据三类数据的格式制定新的type，并将数据导出为这种type的格式。
3. 后续需要整理为tabx格式并上传到wiki。单个tabx会超出wiki的限制，因此需要拆分成多个tabx，并增加统一的dataType字段用于查询。具体拆分方式待定。
4. 上传tabx的方式有直接生成json格式的tabx和先生成xlsx再由wiki解析两种，待定。